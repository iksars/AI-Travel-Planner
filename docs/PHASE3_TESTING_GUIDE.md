# Phase 3 功能快速测试指南

## 🚀 快速启动

### 1. 启动后端服务

```bash
cd backend
npm run dev
```

后端将运行在 `http://localhost:3000`

### 2. 启动前端服务

```bash
cd frontend
npm run dev
```

前端将运行在 `http://localhost:5173`

## 📋 测试步骤

### Step 1: 登录系统

1. 打开浏览器访问 `http://localhost:5173`
2. 点击"登录"
3. 使用已有账号登录，或注册新账号

### Step 2: 创建或打开旅行计划

#### 方式 A：创建新计划
1. 点击"我的旅行计划"
2. 点击"创建新计划"
3. 填写基本信息（目的地、日期、预算等）
4. 保存计划

#### 方式 B：使用 AI 生成
1. 点击"AI 智能规划"
2. 填写旅行需求
3. 等待 AI 生成行程
4. 查看生成的计划

### Step 3: 查看预算分析

1. 进入旅行计划详情页
2. 滚动到"💰 预算与费用"区域
3. 观察预算概览卡片：
   - 💵 总预算
   - 💸 已花费（初始为 0）
   - 💰 剩余
   - 📊 使用比例

### Step 4: 添加费用记录

#### 测试案例 1：交通费用
1. 点击"记录费用"按钮
2. 选择分类：**交通** 🚗
3. 输入金额：**150**
4. 选择日期：今天
5. 描述：**打车去机场**
6. 点击"保存"

#### 测试案例 2：餐饮费用
1. 再次点击"记录费用"
2. 选择分类：**餐饮** 🍽️
3. 输入金额：**80**
4. 选择日期：今天
5. 描述：**午餐**
6. 点击"保存"

#### 测试案例 3：住宿费用
1. 再次点击"记录费用"
2. 选择分类：**住宿** 🏨
3. 输入金额：**300**
4. 选择日期：今天
5. 描述：**酒店一晚**
6. 点击"保存"

### Step 5: 观察数据更新

添加费用后，您应该看到：

1. **预算概览卡片更新**：
   - 已花费：¥530 (150 + 80 + 300)
   - 剩余：根据总预算计算
   - 使用比例：自动更新

2. **进度条变化**：
   - 颜色可能从绿色变为黄色
   - 长度根据使用比例增长

3. **饼图显示**：
   - 交通：28.3%（绿色扇形）
   - 餐饮：15.1%（蓝色扇形）
   - 住宿：56.6%（红色扇形）

4. **折线图显示**：
   - 今天的消费：¥530

5. **费用列表更新**：
   - 显示刚添加的 3 条记录
   - 最新的在最上面

### Step 6: 编辑费用记录

1. 在费用列表中找到"午餐"记录
2. 点击 ✏️ 编辑按钮
3. 修改金额：**100** （原来是 80）
4. 点击"保存"
5. 观察图表和统计数据自动更新

### Step 7: 删除费用记录

1. 在费用列表中找到任意一条记录
2. 点击 🗑️ 删除按钮
3. 在确认对话框中点击"删除"
4. 观察记录被移除，数据重新计算

### Step 8: 测试多日费用

为了测试折线图：

1. 添加昨天的费用：
   - 分类：景点门票
   - 金额：200
   - 日期：选择昨天
   - 描述：故宫门票

2. 添加前天的费用：
   - 分类：购物
   - 金额：500
   - 日期：选择前天
   - 描述：纪念品

3. 观察折线图显示多个日期的消费趋势

## ✅ 预期结果

### 1. 预算概览正常
- ✅ 总预算显示正确
- ✅ 已花费实时更新
- ✅ 剩余预算正确计算
- ✅ 使用比例准确

### 2. 进度条正常
- ✅ 长度随使用比例变化
- ✅ 颜色渐变（绿→黄→红）
- ✅ 超过 100% 显示异常状态

### 3. 图表正常显示
- ✅ 饼图显示分类占比
- ✅ 鼠标悬停显示详细信息
- ✅ 折线图显示每日趋势
- ✅ 图表随数据更新

### 4. 费用列表正常
- ✅ 显示最近 10 条记录
- ✅ 按日期倒序排列
- ✅ 显示分类图标
- ✅ 编辑和删除功能正常

### 5. 对话框功能正常
- ✅ 表单验证生效
- ✅ 数据保存成功
- ✅ 错误提示友好
- ✅ 取消按钮有效

## 🐛 常见问题排查

### 问题 1：图表不显示

**可能原因**：ECharts 未正确安装

**解决方法**：
```bash
cd frontend
npm install echarts vue-echarts
```

### 问题 2：API 请求失败

**可能原因**：后端未启动或端口冲突

**解决方法**：
1. 确认后端运行在 3000 端口
2. 检查终端是否有错误信息
3. 检查 `.env` 文件配置

### 问题 3：认证失败

**可能原因**：Token 过期

**解决方法**：
1. 退出登录
2. 重新登录
3. 清除浏览器缓存

### 问题 4：数据不更新

**可能原因**：数据库问题

**解决方法**：
```bash
cd backend
npx prisma migrate reset
npx prisma migrate dev
```

## 🎯 高级测试

### 测试边界情况

#### 1. 超出预算
- 添加费用直到超过总预算
- 观察剩余预算变为负数（橙色警告）
- 观察进度条变红
- 观察使用比例超过 100%

#### 2. 大量费用
- 添加 20+ 条费用记录
- 观察"最近费用记录"只显示最新 10 条
- 观察图表性能是否流畅

#### 3. 不同分类
- 每种分类都添加至少一条记录
- 观察饼图显示所有分类
- 观察分类统计准确

#### 4. 时间跨度
- 添加跨越多天的费用
- 观察折线图横轴显示所有日期
- 观察消费趋势是否合理

### 测试响应式设计

1. **桌面端**（1920x1080）：
   - 预算卡片 4 列显示
   - 图表并排显示
   - 所有元素正常显示

2. **平板端**（768px）：
   - 预算卡片 2 列显示
   - 图表堆叠显示
   - 布局自适应

3. **手机端**（375px）：
   - 预算卡片 1 列显示
   - 图表全宽显示
   - 按钮和文字大小适中

## 📸 截图建议

测试时建议截图以下场景：

1. **空状态**：没有费用记录时
2. **添加费用**：对话框打开状态
3. **预算概览**：4 个卡片展示
4. **饼图**：费用分类占比
5. **折线图**：每日消费趋势
6. **费用列表**：多条记录展示
7. **超支状态**：预算超支的警告状态
8. **编辑对话框**：编辑费用界面

## 🎉 测试完成

完成所有测试后，您应该已经体验到：

✅ 直观的预算管理界面
✅ 便捷的费用记录功能
✅ 美观的数据可视化
✅ 流畅的用户体验
✅ 完整的增删改查操作
✅ 实时的数据更新
✅ 智能的预算分析

## 📝 反馈

如果发现任何问题或有改进建议，请记录：

- 问题描述
- 复现步骤
- 预期结果
- 实际结果
- 错误信息（如有）
- 浏览器版本和操作系统

---

**祝测试顺利！** 🚀
